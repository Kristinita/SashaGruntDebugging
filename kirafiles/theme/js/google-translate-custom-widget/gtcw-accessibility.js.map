{
  "version": 3,
  "file": "gtcw-accessibility.js",
  "sourceRoot": "../../coffee/google-translate-custom-widget/",
  "sources": [
    "gtcw-accessibility.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "###\n@Author: Kristinita\n@Date: 2023-12-19 13:07:24\n@Last Modified by: Kristinita\n@Last Modified time: 2025-03-02 13:56:38\n###\n\n###\n[OVERVIEW] Make google-custom-translate widget accessible for people use solely keyboard without mouse.\nWe start translation into the language corresponding to the flag\nwhen the user focuses on the flag and presses “Enter”\n\n[REQUIRED] “tabindex=\"0\"” for each “img” tag with gctw flag.\n\n[INFO] Recommended method on Stack Overflow with “addEventListener”:\nhttps://stackoverflow.com/a/45650898/5951529\n\n[NOTE][LEARN][COFFEESCRIPT] CoffeeScript doesn’t support “let” and “const”:\nhttps://coffeescript.org/#unsupported-let-const\n###\nkiraFlags = document.querySelectorAll(\".language__img\")\n\n###\n[INFO] Listen each element of the class “.language__img”:\nhttps://bobbyhadz.com/blog/javascript-add-event-listener-to-all-elements-with-class\n\n[LEARN][COFFEESCRIPT] “for-from” compiled to “for-of” in CoffeeScript:\nhttps://coffeescript.org/#generators\nhttps://stackoverflow.com/a/57637660/5951529\n###\nfor kiraFlag from kiraFlags\n\n\t###\n\t[INFO] “keyup” event — listen keyboard keystrokes:\n\thttps://developer.mozilla.org/en-US/docs/Web/API/Element/keyup_event\n\t###\n\tkiraFlag.addEventListener \"keyup\", (kiraEvent) ->\n\t\tif kiraEvent.key isnt \"Enter\"\n\t\t\treturn\n\n\t\t###\n\t\t[INFO] Get the active (i.e. that currently has focus) HTML element:\n\t\thttps://stackoverflow.com/a/497108/5951529\n\t\t###\n\t\tkiraFocusedFlag = document.activeElement\n\n\t\tkiraFocusedFlag.click()\n\n\t\t### eslint-disable no-console --\n\n\t\t[INFO] I think that the messages about pressing “Enter” on the flag,\n\t\twhich include ISO 639-1 Alpha-2 language codes, the language into which the translation is being performed,\n\t\taren’t debugging information and can be send to the browser users:\n\t\thttps://eslint.org/docs/latest/rules/no-console#when-not-to-use-it\n\t\t###\n\t\tconsole.log \"The “Enter” button is pressed on the flag of a country with\n\t\t\t“#{kiraFocusedFlag.dataset.googleLang}” language\"\n\n\t\t### eslint-enable no-console ###\n\n\t\t###\n\t\t[REQUIRED][INFO] Prevent default browser behavior when pressing the “Enter” key:\n\t\thttps://htmlacademy.ru/blog/js/prevent-default\n\t\t###\n\t\tkiraEvent.preventDefault()\n\t\treturn\n\n\n###\n[PATCH] Add “aria-label” attribute for unlabeled forms.\nThis allows pages with Google Translate to pass accessibility tools tests.\n###\nkiraAddAriaLabelToInput = (kiraNoLabeledFormID, kiraAriaLabelText) ->\n\n\tkiraObjectForModifications = await waitForElm(kiraNoLabeledFormID)\n\n\t###\n\t[INFO] Check, does the tag have “aria-label” attribute:\n\thttps://www.javascripttutorial.net/javascript-dom/javascript-hasattribute/\n\t###\n\tif kiraObjectForModifications.hasAttribute(\"aria-label\")\n\n\t\t### eslint-disable no-console --\n\n\t\t[INFO] I think it’s acceptable to leave “console.error” in the console in this case\n\t\tso that the error can be tracked when the developers fix the problem\n\t\t###\n\n\t\tconsole.error \"“aria-label” attribute already exists for #{kiraObjectForModifications.id} element!\"\n\n\t\t### eslint-enable no-console ###\n\n\telse\n\t\t# [INFO] Add “aria-label” property\n\t\tkiraObjectForModifications.setAttribute \"aria-label\", kiraAriaLabelText\n\n\n# [INFO] Get unlabeled form ids from reports of Pa11y, axe, WAVE or another accessibility tools\nkiraAddAriaLabelToInput \"#goog-gt-votingInputSrcLang\", \"Google Translate form for source language\"\nkiraAddAriaLabelToInput \"#goog-gt-votingInputSrcText\", \"Google Translate form for source text\"\nkiraAddAriaLabelToInput\t\"#goog-gt-votingInputTrgLang\", \"Google Translate form for target language\"\nkiraAddAriaLabelToInput\t\"#goog-gt-votingInputTrgText\", \"Google Translate form for target text\"\nkiraAddAriaLabelToInput\t\"#goog-gt-votingInputVote\", \"Google Translate voting form\"\n\n\n###\n[PATCH] Add “title” attribute for untitled iframes.\n\n[INFO] Iframe titles important for accessibility:\nhttps://www.boia.org/blog/why-are-iframe-titles-important-for-accessibility\nhttps://dequeuniversity.com/tips/provide-iframe-titles\n\n[REQUIRED] Attribute “title” if attribute “name” exists.\n###\nkiraAddTitleToIframe = (kiraUntitledIframe, kiraTitle) ->\n\n\tkiraObjectForModifications = await waitForElm(kiraUntitledIframe)\n\n\tif kiraObjectForModifications.hasAttribute(\"title\")\n\n\t\t### eslint-disable no-console ###\n\n\t\tconsole.error \"“title” attribute already exists for #{kiraObjectForModifications.name} element!\"\n\n\t\t### eslint-enable no-console ###\n\n\telse\n\t\tkiraObjectForModifications.setAttribute \"title\", kiraTitle\n\n\n###\n[LEARN][JAVASCRIPT] Get element with custom selector:\nhttps://sabe.io/blog/javascript-query-elements-data-attribute\n\n[REQUIRED] Use “[id=':0.container']”, not “#:0.container” syntax\nfor iframe with id “:0.container”, otherwise error:\n“Uncaught (in promise) DOMException: Document.querySelector: '#:0.container' is not a valid selector”:\nhttps://stackoverflow.com/a/51396346/5951529\nhttps://stackoverflow.com/a/52390114/5951529\n###\nkiraAddTitleToIframe \"[id=':0.container']\", \"Google Translate Skiptranslate iframe\"\nkiraAddTitleToIframe \"[name='votingFrame']\", \"Google Translate voting iframe\"\nkiraAddTitleToIframe \"[sandbox='allow-scripts']\", \"Google Translate Closure iframe\"\n\n\n###\n[PATCH] Add submit button for “form” elements without it.\n\n[INFO] CodeSniffer example of valid code:\nhttps://github.com/fuzzbomb/HTML_CodeSniffer/commit/57a28d810de0c4dc67f98b5225bb7656c1655df5\n###\nkiraAddSubmitButtonToForm = (kiraUnsubmittedForm, kiraTitle) ->\n\n\tkiraObjectForModifications = await waitForElm(kiraUnsubmittedForm)\n\n\t### eslint-disable no-magic-numbers --\n\n\t[INFO] Remove “#” symbol for adding value to the “form” attribute.\n\tFor example, the button for “<form id=\"goog-gt-votingForm\"></form>”\n\tis “<button form=\"goog-gt-votingForm\"></button>”.\n\tIn this case, “kiraUnsubmittedForm” value is “#goog-gt-votingForm”,\n\t“form” attribute needs “goog-gt-votingForm” — “kiraUnsubmittedForm” without first “#”.\n\n\t[LEARN][JAVASCRIPT] “slice(1)” — remove the first string symbol on JavaScript:\n\thttps://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/slice\n\t###\n\tkiraButtonFormValue = kiraUnsubmittedForm.slice(1)\n\n\tkiraExistingSubmitButton = document.querySelector(\"[form='#{kiraButtonFormValue}']\")\n\n\t### eslint-enable no-magic-numbers --\n\n\t[REQUIRED] “eslint-enable no-magic-numbers” after define “KiraExistingSubmitButton”.\n\tOtherwise, CoffeeScript compile “eslint-enable” before defining all variables.\n\n\t###\n\n\tif(kiraExistingSubmitButton)\n\n\t\t### eslint-disable no-console --\n\n\t\t[REQUIRED] “eslint-enable no-console” after define “KiraSubmitButton”.\n\t\tOtherwise, CoffeeScript compile “eslint-enable” before defining all variables:\n\n\t\t``` js\n\t\t/* esint-enable no-console *\\/\n  \t\tvar kiraButtonFormValue, kiraExistingSubmitButton, kiraObjectForModifications, kiraSubmitButton;\n\t\t```\n\n\t\t###\n\n\t\tconsole.error \"Element with “form='#{kiraButtonFormValue}'” already exists!\"\n\n\telse\n\n\t\tkiraSubmitButton = document.createElement(\"button\")\n\n\t\t### eslint-enable no-console ###\n\n\t\t###\n\t\t[LEARN][JAVASCRIPT] Add “button” element after “form”:\n\t\thttps://stackoverflow.com/a/59360710/5951529\n\t\thttps://developer.mozilla.org/en-US/docs/Web/API/Element/after\n\t\t###\n\t\tkiraObjectForModifications.after(kiraSubmitButton)\n\n\t\t###\n\t\t[REQUIRED] “setattribute()” method after “after()” method.\n\t\t“after()” don’t append tag with attributes.\n\t\t###\n\t\tkiraSubmitButton.setAttribute(\"form\", kiraButtonFormValue)\n\n\t\t###\n\t\t[LEARN][JAVASCRIPT] Safely add text, not HTML to “button” element use “append()” or “prepend()” methods:\n\t\thttps://developer.mozilla.org/en-US/docs/Web/API/Element/append\n\t\thttps://developer.mozilla.org/en-US/docs/Web/API/Element/prepend\n\t\t###\n\t\tkiraSubmitButton.append(\"Submit\")\n\n\nkiraAddSubmitButtonToForm \"#goog-gt-votingForm\", \"Google Translate submit button for voting form\"\n"
  ]
}